linux系统的服务器被入侵，总结了以下的基本方法，供不大懂linux服务器网理人员参考考学习。
首先先用iptraf查下，如果没装的运行yum install iptraf装下，看里面是不是UDP包发的很多，如果是，基本都被人装了后门
1. 检查帐户
# less /etc/passwd
# grep :0: /etc/passwd（检查是否产生了新用户，和UID、GID是0的用户）
# ls -l /etc/passwd（查看文件修改日期）
# awk -F: ‘$3= =0 {print $1}’ /etc/passwd（查看是否存在特权用户）
# awk -F: ‘length($2)= =0 {print $1}’ /etc/shadow（查看是否存在空口令帐户）

2. 检查日志
# last（查看正常情况下登录到本机的所有用户的历史记录）
注意”entered promiscuous mode”
注意错误信息
注 意Remote Procedure Call (rpc) programs with a log entry that includes a large number (> 20) strange characters(-^PM-^PM-^PM-^PM-^PM-^PM-^PM-^PM)

3. 检查进程
# ps -aux（注意UID是0的）
# lsof -p pid（察看该进程所打开端口和文件）
# cat /etc/inetd.conf | grep -v “^#”（检查守护进程）
检查隐藏进程
# ps -ef|awk ‘{print }’|sort -n|uniq >1
# ls /porc |sort -n|uniq >2
# diff 1 2

4. 检查文件
# find / -uid 0 Cperm -4000 Cprint
# find / -size +10000k Cprint
# find / -name “…” Cprint
# find / -name “.. ” Cprint
# find / -name “. ” Cprint
# find / -name ” ” Cprint
注意SUID文件，可疑大于10M和空格文件
# find / -name core -exec ls -l {} ;（检查系统中的core文件）
检查系统文件完整性
# rpm Cqf /bin/ls
# rpm -qf /bin/login
# md5sum Cb 文件名
# md5sum Ct 文件名

5. 检查RPM
# rpm CVa
输出格式：
S C File size differs
M C Mode differs (permissions)
5 C MD5 sum differs
D C Device number mismatch
L C readLink path mismatch
U C user ownership differs
G C group ownership differs
T C modification time differs
注意相关的 /sbin, /bin, /usr/sbin, and /usr/bin

6. 检查网络
# ip link | grep PROMISC（正常网卡不该在promisc模式，可能存在sniffer）
# lsof Ci
# netstat Cnap（察看不正常打开的TCP/UDP端口)
# arp Ca

7. 检查计划任务
注意root和UID是0的schedule
# crontab Cu root Cl
# cat /etc/crontab
# ls /etc/cron.*

8. 检查后门
# cat /etc/crontab
# ls /var/spool/cron/
# cat /etc/rc.d/rc.local
# ls /etc/rc.d
# ls /etc/rc3.d
# find / -type f -perm 4000

9. 检查内核模块
# lsmod

10. 检查系统服务
# chkconfig
# rpcinfo -p（查看RPC服务）

11. 检查rootkit
# rkhunter -c
# chkrootkit -q

12.检查chkconfig 列表，防止一些程序加入到开机自启动中
chkconfig --list